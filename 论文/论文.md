对于需求一，我们要考虑各个利益相关方，如安大略湖沿岸业主和水力发电公司希望安大略湖有稳定的中等水位、环保主义者希望安大略湖有季节性变化的水位，航运公司希望圣劳伦斯河有高且稳定的水位，安大略湖沿岸的业主希望有适中的稳定水位；从上文可以看出，各个利益方的诉求是存在矛盾的，因此我们将各个利益方分为主要利益方：船舶公司、居民、水力发电公司和次要利益方：环保主义者等；此外，通过对湖水位历史数据的分析，可以发现除安大略湖外，其余四个湖面水位均很稳定，所以我们只需要找到这四个湖的较高水位即可；对于安大略湖，在一年中的水位波动较大，因此我们要满足较高水位的前提下，找到最稳定的水位。



通过对历史数据分析，我们将每个月份的平均湖面水位、最大湖面水位、最小湖面水位绘制在同一个图中，如下图所示



我们发现除安大略湖外，其余四个湖面的水位在往年波动非常小，可以近似为稳定；因此为了满足主要利益方，我们应使最佳水位尽可能高，但不能无限制的高，一方面是满足自然规律，另一方面是鉴于2017年、2019年的历史经验，过高的水位会导致洪水泛滥，对人们的生产生活造成严重的影响。
$$
L_{best}^{i} = 0.75 \times L_{max}^{i}  \\
    L_{max}^{i} = max(L_{mean}^{i}) \\
    L_{mean}^{i} = \frac{1}{N_{Year}}\sum_{N_{Year}}L^{i}_{month}\\
    i=\{1,2,3,4\}\\
$$
对于安大略湖，由于其波动较大，如果仅仅类似于公式（1）求解出较大值作为最佳水位的话，则会使一年中水位的波动较大，从而损害主要利益方的利益，因此我们在安大略湖问题上以满足稳定性的前提下，找到水位最高的解：
$$
\begin{align*}
	max \ f(L_{best}^5) &=\sum_{m=1}^{12} (L^{5}_{best}-L^5_{mean})^2 \\
  \operatorname{ s.t. }:  &\ L'{}\leq L_{best}^5 \leq L''\\
  \quad &L'' = L^5_{max} \times 0.75 \\
  &L' = L^5_{min} \times 1.1
\end{align*}
$$
为了求解上式，我们从开始以0.01开始遍历，找到最小的方差，此时的解即为安大略湖最佳水位



最后我们得到的结果如下：



# Task 2

我们根据五大湖的相对位置，考虑到蒸发、降雨等因素，绘制出了五大湖的网络模型示意图

我们根据五大湖网络模型图得到下面的五个微分方程：
$$
\begin{align}
\frac{d z_1}{d t}&=\frac{1}{A_1}\left[P_1+R_1-D_1-E V_1-Q S M(t)\right] \\
\frac{d z_2}{d t}&=\frac{1}{A_2}\left[P_2+R_2+Q S M+Q R_2-E V_2-D_2-K_2\left(z_2-y_{m_2}\right)^2\left(z_2-z_3\right)^{0.5}\right] \\
\frac{d z_3}{d t}&=\frac{1}{A_3}\left[P_3+R_3+k_2\left(z_2-y m_2\right)^2\left(z_2-z_3\right)^{0.5}-Q R_{2}-E V_3\right. \\
\left.-k_3\left(z_3-y m_3\right)^2\left(z_3-z_4\right)^{0.5}+Q R_3\right] \\
\frac{d z_4}{d t}&=\frac{1}{A_4}\left[P_4+R_4+K_3\left(z_3-y_{m_3}\right)^2\left(z_3-z_4\right)^{0.5}-Q R_3-E V_4-D_4\right. \\
\left.-k_4\left(z_4-y_{m_4}\right)^2+Q R_4\right] \\
\frac{d z_5}{d t}&=\frac{1}{A_5}\left[P_5+R_5+k_4\left(z_4-y_{m_4}\right)^2-Q R_4-E V_5-D_5-Q S L(t)\right]
\end{align}
$$
式中的$K_2\left(z_2-y_{m_2}\right)^2\left(z_2-z_3\right)^{0.5}$是经验公式。

+ 上式是根据当前时刻的水位、降雨量等信息预测下一时刻水位的函数，我们将其称为预测器$F$。
  $$
  F(\textbf{x}_t) = \hat{Z}_{t+\Delta t}
  $$
  $\textbf{x}_t$表示当前时刻的水位、降雨量、蒸发量、大坝控制策略等信息，将这些信息输入预测器，即可得到下一时刻的预测值$\hat{Z}_{t+\Delta t}$。

+ 此外，还有一个决策器$G$
  $$
  G(\hat{Z}_{t+\Delta t}) = QSM(t), QSL(t)
  $$
  决策器的输入：下一时刻的水位预测值$\hat{Z}_{t+\Delta t}$

  决策器的输出：当前时刻的最优大坝控制策略$QSM(t),QSL(t)$，以使得下一时刻水位接近最佳水位$Z_{best}$

+ 算法如下：

  1. 传感器测量当前$t$时刻的实际值$\textbf{x}_t$，例如当前时刻的水位、降雨量、蒸发量、大坝控制策略
  2. 将测量值$\textbf{x}_t$输入预测器，得到下一时刻水位预测值$\hat{Z}_{t+\Delta t}$
  3. 将下一时刻水位预测值输入决策器，得到当前时刻最优的大坝控制策略$QSM(t),QSL(t)$
  4. 下一时刻重复步骤1，测得$t+\Delta t$时刻的实际值$\textbf{x}_{t+\Delta t}$，$\textbf{x}_{t+\Delta t}$中包含$Z_{t+\Delta t}$。根据真实值与预测值的差值$\hat{Z}_{t+\Delta t}-Z_{t+\Delta t}$优化预测器$F$和决策器$G$
  5. 直至预测器和决策器都被充分优化，即预测器可以根据已有信息准确预测出下一时刻的水位，决策器可以根据下一时刻水位制定出最优大坝控制策略，显然，只有当预测器预测精度高且决策器决定策略正确的时候，两模型相互配合才可以得到最优解。

  

  ### 模型改进

  公式{} - {}中，$k_i, y, m_i$是由经验公式得来，这意味着我们的预测器将是固定的，无法随着时间的推移而优化。因此我们将$k_i, y, m_i$设定为待学习的参数，在每一次预测的过程中都会被优化，即预测器和决策器同时被优化。

  

  #### 模型解决

  我们以1918-2022年五大湖的水位为训练数据，Adam为优化器，3e-4为学习率，对预测器和决策器同时训练了100个EPOCH，可以发现模型较难同时收敛，损失呈现波动下降的趋势，但随着EPOCH的增加，两模型的损失都是在降低的，最终达到收敛。

  #### 模型改进

  Our work

  + Devised an algorithm to balance stakeholder interests for optimal water level determination.
  + Engineered a dynamic dam control strategy, integrating predictive models with decision-making frameworks.
  + Trained a Long Short-Term Memory (LSTM) model on historical data sets for the 2024 water level prediction, incorporating these projections into the control algorithm to assess model performance.



	#### 结果

我们根据预测出的2024年五大湖面水位仿真了大坝控制算法，得到不同时刻由大坝控制的苏比列尔湖和安大略湖的放水量：

根据这些策略，我们仿真了五大湖的水位变化情况，可以发现在初始时刻，五大湖的水位都与其最佳水位有较大偏差，但在大坝控制策略的调整下，它们的水位逐渐向最佳水位逼近，并在允许的一定误差范围内，水位控制在了最佳水位附近。



#### 问题三结果分析

由于2017年流域内爆发了洪水，从图中可以看出五大湖一整年的水位都高于第一问中得出的最佳水位，这会严重损害各方权益；我们的水坝控制算法有效的减小了流域内湖面的水位，相较于实际数据更加接近最佳水位；但另一方面，为了降低水位，模型采取了较为极端的控制策略，使得水位波动增大，尤其是苏必利尔湖，这也会让一部分人的权益受到损害。总的来说，本文的模型在2017年洪水发生时，在保证大部分人的利益下，可以有效的控制水位。



#### 问题四建模

显然，每个时刻的水位都会受到各个环境参量的联合影响，具体表现为：环境参量影响预测器预测精度，导致下一时刻的预测值与实际值误差增大，决策器根据不准确的预测值做出的决策肯定是错误的。

为了建模环境参量对模型的影响，我们将问题2中的大坝控制模型视为一个函数：
$$
QSM(t), QSL(t)=f(\textbf{X})
$$
其中$\textbf{X}$是模型$d$个不确定输入$\{X_1, X_2, \cdots,X_d\}$；为不损失一般性，我们假设$\textbf{X}$在超立方体内独立均匀分布，这样就可以把模型输出的方差分解为每个输入对其的单独影响和它们的联合影响：
$$
\operatorname{Var}(Y)=\sum_{i=1}^dV_i+\sum_{i<j}^dV_{ij}+\cdots+V_{12\ldots d}\\
\begin{equation}
		\nonumber
    \begin{aligned}&V_i=\mathrm{Var}_{X_i}\left(E_{\mathbf{X}_{\sim i}}\left(Y\mid X_i\right)\right),\\&V_{ij}=\mathrm{Var}_{X_{ij}}\left(E_{\mathbf{X}_{\sim ij}}\left(Y\mid X_i,X_j\right)\right)-V_i-V_j\end{aligned}
\end{equation}
$$
本文中，$X_i$即代表输入模型的各个参数，例如降雨量、蒸发量等。当环境发生变化时，$X_i$也会随之发生变化，求出$V_i$，即可定量分析$X_i$对输出的影响，即单个环境变量发生变化对模型的影响。
$$
S_i=\frac{V_i}{\mathrm{Var}(Y)}\\
\sum_{i=1}^dS_i+\sum_{i<j}^dS_{ij}+\cdots+S_{12\ldots d}=1
$$
$S_i$是$X_i$对模型的“主效应指数”，表示$X_i$对输出方差的贡献。

进一步，我们可以分析多个环境变量$X_i,X_j$均发生变化时的模型输出方差$V_{ij}$，即分析多个环节变量发生变化时对模型的影响，同理：
$$
S_{ij}=\frac{V_{ij}}{\mathrm{Var}(Y)}
$$

#### 问题四求解

采用蒙特卡洛方法在单位超立方体内生成一系列随机分布的点，即模拟随机的环境变化



#### 问题四结果分析

1. **参数的相对重要性**:
   - 从图中可以看出，[Variable1] 和 [Variable2] 的主效应和总效应指数都相对较高，表明这两个参数对模型输出的大坝控制策略影响较大。从另一个方面看，我们在[前文的模拟图]中可以看出，春天和冬天的水位波动较大，即我们的模型受到[Variable1] 和 [Variable2] 的较大，对水位的控制较差。
2. **参数间的交互作用**:
   - 总效应指数通常包括了主效应和由于参数间交互作用产生的效应。如果一个参数的总效应指数明显高于其主效应指数，这表明该参数可能与其他参数有显著的交互作用。对于我们的模型，所有参数的总效应指数都略高于其主效应指数，表明存在这种交互作用，这也符合实际，当多个环境变量变化时，模型收到的影响是这些变量的联合作用。
3. **优化和改进的方向**:
   - 对于那些对模型输出影响较大的参数（如[Variable1] 和 [Variable2] ），在模型设计和数据收集过程中，可能需要更多的关注和精确控制。
   - 同时，对于影响较小的参数（如[Variable1] 和 [Variable2]和[Variable3] ），可以考虑是否有简化模型的可能性，例如减少这些参数的复杂度或者在某些情况下忽略它们的细微变化。
4. **模型的鲁棒性和灵敏度**:
   - 通过分析主效应和总效应，可以对模型的鲁棒性（即对输入变化的敏感程度）有一个大致的了解。在这个示例中，由于 `x1` 和 `x2` 对输出有较大影响，模型在这两个参数上可能比较敏感，因此在使用模型时需要确保这些参数的准确性和稳定性。













#### 摘要

对于需求一，我们提出了一个可以权衡各利益方权益的模型，并根据历史水位信息分析把利益方分为主要利益方和次要利益方；此外我们根据湖面水位的波动大小对湖分类并采取不同的优化策略。最后得出了五大湖水位分别为：183.35、176.33、175.10、174.28、74.82m，为后文优化控制策略定下了基准。

对于需求二，本文提出了微分预测器、MPC决策器联合模型，并对模型做出了修正，使其可以利用机器学习算法迭代优化。本文使用1918-2022年的对修正模型训练至收敛。经过对比后，发现修正后的模型在控制水位效果上显著优于MPC决策模型，在一定的误差范围内把五大湖水位均控制在最佳水位。

对于需求三，本文沿用需求二中的模型，在预测阶段对模型不进行更新，把2017年真实降雨量等环境变量输入模型，得到在大坝决策模型控制下的水位，通过与2017年实际水位对比，发现我们的水坝控制算法有效的减小了流域内湖面的水位，相较于实际数据更加接近最佳水位，证明我们的模型在应对极端天气条件下仍有效，对特定环境具有较低的敏感度。

对于需求四，本文采用Sobol算法分析模型敏感度，把环境变量{}对模型的影响分解为单独的主效应指数和联合作用时的总效应指数，并利用python第三方库SAlib使用蒙特卡洛方法，在随机变量超立方体中生成大量独立正态分布的样本，得到最终的结果：支流汇入和滞冰率对模型的影响与其余变量相比更大；多个变量同时变化对单个变量变化对模型的影响更大。

对于需求五，本文进一步对安大略湖和圣劳伦斯河地区的利益相关方进行了分析，分别从经济效益、生态效益以及利益敏感度的角度对各利益相关方的权重进行了衡量，并且根据各利益相关方的诉求随一年中的时间不断变化的特点，将需求一中的全年最佳水位细化为每个季度的最佳水位以及圣劳伦斯河的最佳流量，进而更好地满足各方需求。在水系的影响因素方面，进一步考虑了各河流对于圣劳伦斯河在不同季节的汇入效应和春季冰雪融化效应，建立了更加全面的多目标优化模型。通过对于模型的训练和求解，进一步验证了本文所提出控制策略的合理性。





*Your Role:* *You're Xinstein - the Best Research & Explainer Agent on Planet Earth.* *Your Job:* *Explain <Topic> in every possible way to make it easy to understand.* *Your Motive:* *Give the learner "aha" moment on every <Topic> he needs to understand. You can do this with the art of explaining things.* *Learner's introduction:* *The learner knows nothing! He's a complete beginner. He only understands simple language with no jargon and heavy grammar. He loves to visualize concepts, it makes him understand better.* *Your Method:* *Step 1:* *Search the internet for the latest information on <Topic>. Find the most relatable information about the <Topic>.* *Step 2:* *Summarize all pieces of content you found, separately. When summarizing, write the most important points you found in the content.* *Note:* *Most important in the sense that this information will help the learner to understand the "what is this <topic>?"* *Don't pick the same information from all summaries. Always find something new in the next summary.* *Write detailed summaries, 500 words minimum And make summaries super valuable.* *Step 3:* *Use "Explain in a 5th Grade student language" method to simplify the concept first.* *Step 4:* *Explain the full concept in step by step manner. Use simple language.* *Step 5:* *Use the "whimsical diagrams" plugin to design the diagrams to explain the concept. It will help the reader to understand better.* *Note:* *Visual representation includes mindmap, Use Case Diagram, Process flow diagram and Data-flow diagram. Generate all 4 diagrams.* *Step 6:* *Share 1 most realistic analogy and 2 Metaphors to explain the concept.* *Step 7:* *Share key Takeaways of the <Topic>* *Rules:* *1.* *I know you have token limitations, so don't skip any steps and don't find shortcuts. When you're about to hit your token limit. Ask me to press "continue" and I'll do that so you can complete all steps.* *2.* *Start with introducing yourself first, then ask "What's the Topic you want to understand?" And the user will share the topic.* *Do you understand?*